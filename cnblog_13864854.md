---
title: ç¬¬ä¸€æ¬¡å·®å¼‚åˆ†æ
date: 2020-10-23 08:31:00
categories:
- ç¬”è®°
- åšå®¢å›­
tags:
- åšå®¢å›­
- æ¬å®¶
- cnblogs
---
# [è¿™æ˜¯ğŸ‘‰ç¬¬ä¸€æ¬¡å·®å¼‚åˆ†æğŸ‘ˆçš„æ‘˜è¦](../../../../2020/10/23/cnblog_13864854/)
<!--more-->
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(ggthemes)) library(DESeq2)
options(stringsAsFactors = F) #sTart rm(list =ls() )
setwd("C://Users/aklasim/Desktop/12såŸæ ¸è½¬å½•ç»„ç»“æœ/07.DiffExpAnnotation/1.GO") rc_all
<\-
read.table("C://Users/aklasim/Desktop/12såŸæ ¸è½¬å½•ç»„ç»“æœ/05.GeneExp/genes.read.txt")
#class counts <\- as.matrix(rc_all) rc_24 <\- as.matrix(counts[,c(1:4)]) rc_3
<\- counts[,c(5:8)] rc_9 <\- counts[,9:12] #condition condition <\-
factor(c("trt","trt","untrt","untrt")) col_data <\- data.frame(row.names =
colnames(rc_3), condition) #bb = (colnames()) dds <\-
DESeqDataSetFromMatrix(countData = rc_3, colData = col_data , design = ~
condition); #a ##b if (!file.exists(tem_f)) { dds <\- DESeq(dds) # æ ‡å‡†åŒ–
save(dds,file = tem_f) } load(file = tem_f)# ç»“æœç”¨`result()`å‡½æ•°æå– res <\-
results(dds, contrast = c("condition","untrt","trt")) # å·®å¼‚åˆ†æç»“æœ resOrdered <\-
res[order(res$padj),] # å¯¹ç»“æœæŒ‰ç…§è°ƒæ•´åçš„på€¼è¿›è¡Œæ’åº head(resOrdered) summary(res) DEG <\-
as.data.frame(resOrdered) DESeq2_DEG <\- na.omit(DEG) diff <\-
subset(DESeq2_DEG,pvalue < 0.05) #å…ˆç­›é€‰På€¼ up <\- subset(diff,log2FoldChange > 2)
#ä¸Šè°ƒ down <\- subset(diff,log2FoldChange < -2) #ä¸‹è°ƒ DEG_data <\- DESeq2_DEG
DEG_data$logP <\- -log10(DEG_data$padj) # å¯¹å·®å¼‚åŸºå› çŸ«æ­£åp-valueè¿›è¡Œlog10()è½¬æ¢
dim(DEG_data) #å°†åŸºå› åˆ†ä¸ºä¸‰ç±»ï¼šnot-siginficantï¼Œupï¼Œdowm
#å°†adj.P.valueå°äº0.05ï¼ŒlogFCå¤§äº2çš„åŸºå› è®¾ç½®ä¸ºæ˜¾è‘—ä¸Šè°ƒåŸºå› 
#å°†adj.P.valueå°äº0.05ï¼ŒlogFCå°äº-2çš„åŸºå› è®¾ç½®ä¸ºæ˜¾è‘—ä¸Šè°ƒåŸºå›  DEG_data$Group <\- "not-siginficant"
DEG_data$Group[which((DEG_data$padj < 0.05) & DEG_data$log2FoldChange > 2)] =
"up-regulated" DEG_data$Group[which((DEG_data$padj < 0.05) &
DEG_data$log2FoldChange < -2)] = "down-regulated" table(DEG_data$Group)
#write.csv(DEG_data,'24hbd.csv') DEG_data <\-
DEG_data[order(DEG_data$padj),]#å¯¹å·®å¼‚è¡¨è¾¾åŸºå› è°ƒæ•´åçš„på€¼è¿›è¡Œæ’åº up_label <\-
head(DEG_data[DEG_data$Group == "up-regulated",],1) down_label <\-
head(DEG_data[DEG_data$Group == "down-regulated",],1) deg_label_gene <\-
data.frame(gene = c(rownames(up_label),rownames(down_label)), label =
c(rownames(up_label),rownames(down_label))) DEG_data$gene <\-
rownames(DEG_data) DEG_data <\- merge(DEG_data,deg_label_gene,by = 'gene',all
= T) #æ·»åŠ ç‰¹å®šåŸºå› label ggscatter(DEG_data,x = "log2FoldChange",y = "logP", color =
"Group", palette = c("green","gray","red"), label = DEG_data$gene, repel = T,
ylab = "-log10(Padj)", size = 1) + theme_base()+ theme(element_line(size =
0),element_rect(size = 1.5))+ #åæ ‡è½´çº¿æ¡å¤§å°è®¾ç½® scale_y_continuous(limits = c(0,8))+
scale_x_continuous(limits = c(-18,18))+ geom_hline(yintercept = 1.3,linetype =
"dashed")+ geom_vline(xintercept = c(-2,2),linetype = "dashed") ##ç«å±±å›¾
![](https://img2020.cnblogs.com/blog/2015058/202010/2015058-20201024113830369-298274844.png)


